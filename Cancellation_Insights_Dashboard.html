<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Cancellation Insights Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=DM+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
<style>
  :root {
    --payment:  #e53e3e;
    --natural:  #3b82f6;
    --service:  #f97316;
    --other:    #94a3b8;
    --bg:       #830d0d;
    --surface:  #1a1d27;
    --surface2: #22263a;
    --border:   #2e3350;
    --text:     #e8eaf6;
    --muted:    #8892b0;
    --accent:   #a78bfa;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'DM Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    padding: 28px 24px 48px;
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  .header {
    text-align: center;
    margin-bottom: 36px;
  }
  .header h1 {
    font-family: 'DM Serif Display', serif;
    font-size: clamp(1.8rem, 4vw, 2.8rem);
    letter-spacing: -0.5px;
    background: linear-gradient(135deg, #e8eaf6 30%, var(--accent));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 8px;
  }
  .header p { color: var(--muted); font-size: 1rem; font-weight: 400; }

  /* ‚îÄ‚îÄ NAV TABS ‚îÄ‚îÄ */
  .tabs {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 32px;
    flex-wrap: wrap;
  }
  .tab {
    padding: 9px 20px;
    border-radius: 999px;
    border: 1.5px solid var(--border);
    background: var(--surface);
    color: var(--muted);
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all .2s;
    display: flex;
    align-items: center;
    gap: 7px;
  }
  .tab .dot { width: 9px; height: 9px; border-radius: 50%; }
  .tab:hover { border-color: var(--accent); color: var(--text); }
  .tab.active { background: var(--accent); border-color: var(--accent); color: #fff; }
  .tab.active .dot { background: #fff !important; }

  /* ‚îÄ‚îÄ PANELS ‚îÄ‚îÄ */
  .panel { display: none; }
  .panel.active { display: block; animation: fadeIn .35s ease; }
  @keyframes fadeIn { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:none; } }

  /* ‚îÄ‚îÄ KPI ROW ‚îÄ‚îÄ */
  .kpi-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 16px;
    margin-bottom: 28px;
  }
  .kpi {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 20px;
    position: relative;
    overflow: hidden;
  }
  .kpi::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: var(--accent-color, var(--accent));
    border-radius: 16px 16px 0 0;
  }
  .kpi-label { font-size: 0.75rem; color: var(--muted); text-transform: uppercase; letter-spacing: 0.8px; margin-bottom: 6px; }
  .kpi-value { font-size: 2rem; font-weight: 700; line-height: 1; color: var(--accent-color, var(--text)); }
  .kpi-sub { font-size: 0.78rem; color: var(--muted); margin-top: 4px; }

  /* ‚îÄ‚îÄ GRID LAYOUTS ‚îÄ‚îÄ */
  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
  .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px; }
  @media (max-width: 900px) { .grid-2, .grid-3 { grid-template-columns: 1fr; } }

  /* ‚îÄ‚îÄ CARD ‚îÄ‚îÄ */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 18px;
    padding: 24px;
  }
  .card-title {
    font-size: 0.78rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--muted);
    margin-bottom: 18px;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .card-title span { font-size: 1rem; }

  /* ‚îÄ‚îÄ DONUT ‚îÄ‚îÄ */
  .donut-wrap { position: relative; width: 180px; height: 180px; margin: 0 auto 20px; }
  svg.donut { transform: rotate(-90deg); }
  .donut-center {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    pointer-events: none;
  }
  .donut-center .big { font-size: 1.9rem; font-weight: 700; line-height: 1; }
  .donut-center .small { font-size: 0.72rem; color: var(--muted); margin-top: 2px; }

  /* ‚îÄ‚îÄ LEGEND ‚îÄ‚îÄ */
  .legend { display: flex; flex-direction: column; gap: 10px; }
  .legend-item { display: flex; align-items: center; gap: 10px; cursor: pointer; }
  .legend-dot { width: 12px; height: 12px; border-radius: 3px; flex-shrink: 0; }
  .legend-label { font-size: 0.82rem; flex: 1; }
  .legend-pct { font-size: 0.82rem; font-weight: 700; }
  .legend-bar-wrap { flex: 1; height: 5px; background: var(--surface2); border-radius: 99px; overflow: hidden; }
  .legend-bar { height: 100%; border-radius: 99px; transition: width .8s cubic-bezier(.4,0,.2,1); }

  /* ‚îÄ‚îÄ HORIZONTAL BAR CHART ‚îÄ‚îÄ */
  .hbar { display: flex; flex-direction: column; gap: 11px; }
  .hbar-item { display: grid; grid-template-columns: 1fr auto; align-items: center; gap: 8px; }
  .hbar-label { font-size: 0.78rem; color: var(--text); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .hbar-track { height: 26px; background: var(--surface2); border-radius: 6px; overflow: hidden; position: relative; }
  .hbar-fill { height: 100%; border-radius: 6px; transition: width 1s cubic-bezier(.4,0,.2,1); display: flex; align-items: center; padding-left: 8px; }
  .hbar-fill span { font-size: 0.72rem; font-weight: 700; color: #fff; white-space: nowrap; }
  .hbar-count { font-size: 0.75rem; color: var(--muted); text-align: right; min-width: 40px; }

  /* ‚îÄ‚îÄ HISTOGRAM ‚îÄ‚îÄ */
  .hist-wrap { display: flex; align-items: flex-end; gap: 4px; height: 160px; position: relative; padding-bottom: 24px; }
  .hist-bar-outer { flex: 1; display: flex; flex-direction: column; justify-content: flex-end; position: relative; height: 100%; }
  .hist-bar {
    border-radius: 4px 4px 0 0;
    transition: height 1s cubic-bezier(.4,0,.2,1);
    cursor: pointer;
    position: relative;
  }
  .hist-bar:hover { filter: brightness(1.3); }
  .hist-bar-outer .x-label {
    position: absolute;
    bottom: -22px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.65rem;
    color: var(--muted);
    white-space: nowrap;
  }
  .hist-line {
    position: absolute;
    top: 0; bottom: 24px;
    width: 2px;
    border-left: 2px dashed;
    z-index: 10;
    pointer-events: none;
  }
  .hist-line-label {
    position: absolute;
    top: 0;
    font-size: 0.68rem;
    font-weight: 700;
    white-space: nowrap;
    padding: 2px 5px;
    border-radius: 4px;
  }
  .hist-tooltip {
    position: absolute;
    bottom: calc(100% + 6px);
    left: 50%;
    transform: translateX(-50%);
    background: #1e2230;
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 4px 8px;
    font-size: 0.7rem;
    white-space: nowrap;
    display: none;
    z-index: 20;
  }
  .hist-bar:hover .hist-tooltip { display: block; }

  /* ‚îÄ‚îÄ ALERT BOX ‚îÄ‚îÄ */
  .alert {
    border-radius: 14px;
    padding: 16px 20px;
    margin-bottom: 20px;
    border-left: 4px solid;
    display: flex;
    gap: 12px;
    align-items: flex-start;
  }
  .alert-icon { font-size: 1.4rem; flex-shrink: 0; }
  .alert-title { font-size: 0.9rem; font-weight: 700; margin-bottom: 4px; }
  .alert-body { font-size: 0.82rem; color: var(--muted); line-height: 1.6; }
  .alert.red { background: rgba(229,62,62,.08); border-color: var(--payment); }
  .alert.red .alert-title { color: var(--payment); }
  .alert.blue { background: rgba(59,130,246,.08); border-color: var(--natural); }
  .alert.blue .alert-title { color: var(--natural); }
  .alert.orange { background: rgba(249,115,22,.08); border-color: var(--service); }
  .alert.orange .alert-title { color: var(--service); }
  .alert.purple { background: rgba(167,139,250,.08); border-color: var(--accent); }
  .alert.purple .alert-title { color: var(--accent); }

  /* ‚îÄ‚îÄ TOOLTIP ‚îÄ‚îÄ */
  .tooltip-wrap { position: relative; display: inline-block; }
  .tooltip-box {
    display: none;
    position: absolute;
    bottom: 110%;
    left: 50%;
    transform: translateX(-50%);
    background: #1e2230;
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 8px 12px;
    font-size: 0.75rem;
    white-space: nowrap;
    z-index: 100;
    pointer-events: none;
  }
  .tooltip-wrap:hover .tooltip-box { display: block; }

  /* ‚îÄ‚îÄ PROGRESS LIST ‚îÄ‚îÄ */
  .prog-list { display: flex; flex-direction: column; gap: 12px; }
  .prog-item { }
  .prog-header { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.8rem; }
  .prog-track { height: 8px; background: var(--surface2); border-radius: 99px; overflow: hidden; }
  .prog-fill { height: 100%; border-radius: 99px; transition: width 1s cubic-bezier(.4,0,.2,1); }

  /* ‚îÄ‚îÄ ANNOTATION ‚îÄ‚îÄ */
  .annotation {
    font-size: 0.75rem;
    color: var(--muted);
    text-align: center;
    margin-top: 10px;
    font-style: italic;
  }
</style>
</head>
<body>

<div class="header">
  <h1>Cancellation Insights Dashboard</h1>
  <p>11,811 cancellations analysed ‚Äî 4 key stories from your data</p>
</div>

<!-- TABS -->
<div class="tabs">
  <button class="tab active" onclick="switchTab('overview')" id="tab-overview">
    <span class="dot" style="background:#a78bfa"></span> Full Overview
  </button>
  <button class="tab" onclick="switchTab('payment')" id="tab-payment">
    <span class="dot" style="background:var(--payment)"></span> Payment Crisis
  </button>
  <button class="tab" onclick="switchTab('natural')" id="tab-natural">
    <span class="dot" style="background:var(--natural)"></span> Natural Churn
  </button>
  <button class="tab" onclick="switchTab('service')" id="tab-service">
    <span class="dot" style="background:var(--service)"></span> Service Problems
  </button>
  <button class="tab" onclick="switchTab('time')" id="tab-time">
    <span class="dot" style="background:#10b981"></span> Time is Critical
  </button>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PANEL 1 ‚Äî OVERVIEW
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="panel active" id="panel-overview">

  <!-- KPIs -->
  <div class="kpi-row">
    <div class="kpi" style="--accent-color:#a78bfa">
      <div class="kpi-label">Total Cancellations</div>
      <div class="kpi-value">11,811</div>
      <div class="kpi-sub">out of 16,442 policies</div>
    </div>
    <div class="kpi" style="--accent-color:var(--payment)">
      <div class="kpi-label">Payment Crisis</div>
      <div class="kpi-value">20.6%</div>
      <div class="kpi-sub">2,434 preventable losses</div>
    </div>
    <div class="kpi" style="--accent-color:var(--natural)">
      <div class="kpi-label">Natural Churn</div>
      <div class="kpi-value">58.4%</div>
      <div class="kpi-sub">life-change driven exits</div>
    </div>
    <div class="kpi" style="--accent-color:var(--service)">
      <div class="kpi-label">Service Issues</div>
      <div class="kpi-value">9.4%</div>
      <div class="kpi-sub">fixable right now</div>
    </div>
    <div class="kpi" style="--accent-color:#10b981">
      <div class="kpi-label">Avg Before Cancel</div>
      <div class="kpi-value">5.9 mo</div>
      <div class="kpi-sub">first year is critical</div>
    </div>
  </div>

  <div class="grid-2">
    <!-- Donut -->
    <div class="card">
      <div class="card-title"><span>‚óâ</span> Cancellation Categories</div>
      <div class="donut-wrap">
        <svg class="donut" width="180" height="180" viewBox="0 0 180 180" id="donut-svg"></svg>
        <div class="donut-center">
          <div class="big">11,811</div>
          <div class="small">cancellations</div>
        </div>
      </div>
      <div class="legend" id="donut-legend"></div>
    </div>

    <!-- Top 10 Bar -->
    <div class="card">
      <div class="card-title"><span>‚â°</span> Top 10 Cancellation Reasons</div>
      <div class="hbar" id="top10-bars"></div>
    </div>
  </div>

  <!-- Alert summary -->
  <div class="grid-3">
    <div class="alert red">
      <div class="alert-icon">üî¥</div>
      <div>
        <div class="alert-title">Payment Crisis ‚Äî Act Now</div>
        <div class="alert-body">2,434 customers lost to failed payments and unreachable clients. Completely preventable with better systems.</div>
      </div>
    </div>
    <div class="alert blue">
      <div class="alert-icon">üîµ</div>
      <div>
        <div class="alert-title">Natural Churn Dominates</div>
        <div class="alert-body">58% leave due to life changes (moving home, employer schemes). Hard to stop, but worth understanding.</div>
      </div>
    </div>
    <div class="alert orange">
      <div class="alert-icon">üü†</div>
      <div>
        <div class="alert-title">Service Issues Are Fixable</div>
        <div class="alert-body">1,106 left due to price, claims, or service quality ‚Äî all within your control to improve.</div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PANEL 2 ‚Äî PAYMENT CRISIS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="panel" id="panel-payment">

  <div class="alert red">
    <div class="alert-icon">üö®</div>
    <div>
      <div class="alert-title">The Payment Crisis: 2,434 customers you didn't have to lose</div>
      <div class="alert-body">These customers didn't choose to leave ‚Äî they had a failed payment, an expired card, or simply couldn't be reached. With proper retry logic and proactive alerts, most of these could be saved.</div>
    </div>
  </div>

  <div class="kpi-row">
    <div class="kpi" style="--accent-color:var(--payment)">
      <div class="kpi-label">Lost to Payments</div>
      <div class="kpi-value">2,434</div>
      <div class="kpi-sub">20.6% of all cancellations</div>
    </div>
    <div class="kpi" style="--accent-color:#f87171">
      <div class="kpi-label">Premiums Not Received</div>
      <div class="kpi-value">1,663</div>
      <div class="kpi-sub">68% of payment cases</div>
    </div>
    <div class="kpi" style="--accent-color:#fca5a5">
      <div class="kpi-label">Unreachable After 7 Days</div>
      <div class="kpi-value">696</div>
      <div class="kpi-sub">29% of payment cases</div>
    </div>
    <div class="kpi" style="--accent-color:#fecaca">
      <div class="kpi-label">Chargebacks</div>
      <div class="kpi-value">75</div>
      <div class="kpi-sub">3% of payment cases</div>
    </div>
  </div>

  <div class="grid-2">
    <!-- Payment breakdown bars -->
    <div class="card">
      <div class="card-title"><span>‚â°</span> Payment Issue Breakdown</div>
      <div class="hbar">
        <div>
          <div class="hbar-item">
            <div class="hbar-label">Subsequent premium not received</div>
            <div class="hbar-count">1,663</div>
          </div>
          <div class="hbar-track" style="margin-top:4px">
            <div class="hbar-fill" style="width:68%;background:var(--payment)">
              <span>68%</span>
            </div>
          </div>
        </div>
        <div>
          <div class="hbar-item">
            <div class="hbar-label">Customer unreachable after 7 days</div>
            <div class="hbar-count">696</div>
          </div>
          <div class="hbar-track" style="margin-top:4px">
            <div class="hbar-fill" style="width:29%;background:#f87171">
              <span>29%</span>
            </div>
          </div>
        </div>
        <div>
          <div class="hbar-item">
            <div class="hbar-label">Chargeback</div>
            <div class="hbar-count">75</div>
          </div>
          <div class="hbar-track" style="margin-top:4px">
            <div class="hbar-fill" style="width:3%;background:#fca5a5; min-width:36px">
              <span>3%</span>
            </div>
          </div>
        </div>
      </div>

      <div style="margin-top:24px">
        <div class="card-title"><span>‚óë</span> By Payment Interval</div>
        <div class="prog-list" id="pay-interval-list"></div>
      </div>
    </div>

    <!-- Action plan -->
    <div class="card">
      <div class="card-title"><span>‚ú¶</span> Why This Matters & What To Do</div>
      <div style="font-size:0.85rem; line-height:1.8; color:var(--text); margin-bottom:16px">
        These customers did <strong>not actively choose to leave</strong>. A failed payment or unreturned call ended their policy. Compare:
      </div>

      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:20px">
        <div style="background:rgba(229,62,62,.1); border-radius:12px; padding:14px; text-align:center;">
          <div style="font-size:1.6rem; font-weight:700; color:var(--payment)">~$5,174</div>
          <div style="font-size:0.75rem; color:var(--muted)">avg policy value</div>
        </div>
        <div style="background:rgba(229,62,62,.1); border-radius:12px; padding:14px; text-align:center;">
          <div style="font-size:1.6rem; font-weight:700; color:var(--payment)">~$12.6M</div>
          <div style="font-size:0.75rem; color:var(--muted)">estimated annual risk</div>
        </div>
      </div>

      <div style="font-size:0.8rem; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:1px; margin-bottom:10px">Quick Wins</div>
      <div style="display:flex; flex-direction:column; gap:8px; font-size:0.82rem;">
        <div style="display:flex; gap:8px; align-items:center; background:var(--surface2); padding:10px 12px; border-radius:10px;">
          <span style="color:#10b981; font-size:1rem;">‚úì</span>
          <span>Automated payment retry (3 attempts over 5 days)</span>
        </div>
        <div style="display:flex; gap:8px; align-items:center; background:var(--surface2); padding:10px 12px; border-radius:10px;">
          <span style="color:#10b981; font-size:1rem;">‚úì</span>
          <span>Card expiration alerts 30 days before</span>
        </div>
        <div style="display:flex; gap:8px; align-items:center; background:var(--surface2); padding:10px 12px; border-radius:10px;">
          <span style="color:#10b981; font-size:1rem;">‚úì</span>
          <span>SMS + email (not just email) before cancellation</span>
        </div>
        <div style="display:flex; gap:8px; align-items:center; background:var(--surface2); padding:10px 12px; border-radius:10px;">
          <span style="color:#10b981; font-size:1rem;">‚úì</span>
          <span>7-day grace period before formal cancellation</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PANEL 3 ‚Äî NATURAL CHURN
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="panel" id="panel-natural">

  <div class="alert blue">
    <div class="alert-icon">üåä</div>
    <div>
      <div class="alert-title">Natural Churn: 58.4% of cancellations are life-driven exits</div>
      <div class="alert-body">Most customers don't leave because of a bad experience. They leave because their life changed ‚Äî they moved home, got employer coverage, or only ever needed short-term cover. These are expected, but still worth monitoring.</div>
    </div>
  </div>

  <div class="kpi-row">
    <div class="kpi" style="--accent-color:var(--natural)">
      <div class="kpi-label">Natural Churn Total</div>
      <div class="kpi-value">6,892</div>
      <div class="kpi-sub">58.4% of all cancellations</div>
    </div>
    <div class="kpi" style="--accent-color:#60a5fa">
      <div class="kpi-label">Moving Home</div>
      <div class="kpi-value">3,021</div>
      <div class="kpi-sub">#1 single reason (25.6%)</div>
    </div>
    <div class="kpi" style="--accent-color:#93c5fd">
      <div class="kpi-label">Moving to Local Cover</div>
      <div class="kpi-value">1,723</div>
      <div class="kpi-sub">14.6% ‚Äî competitive loss</div>
    </div>
    <div class="kpi" style="--accent-color:#bfdbfe">
      <div class="kpi-label">Employer Scheme</div>
      <div class="kpi-value">1,199</div>
      <div class="kpi-sub">10.2% ‚Äî job changes</div>
    </div>
  </div>

  <div class="grid-2">
    <div class="card">
      <div class="card-title"><span>‚â°</span> Natural Churn Reasons ‚Äî Ranked</div>
      <div class="hbar">
        <div>
          <div class="hbar-item"><div class="hbar-label">Moving back to country of residence</div><div class="hbar-count">3,021</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:100%;background:var(--natural)"><span>43.8%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Moving on to a Local Cover</div><div class="hbar-count">1,723</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:57%;background:#3b82f6"><span>25.0%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Moving onto Employer scheme</div><div class="hbar-count">1,199</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:40%;background:#60a5fa"><span>17.4%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Less than 12 months - short term</div><div class="hbar-count">707</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:23%;background:#93c5fd"><span>10.3%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Visa cancelled by employer</div><div class="hbar-count">242</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:8%;background:#bfdbfe; min-width:36px"><span>3.5%</span></div></div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-title"><span>‚ú¶</span> What To Do About Natural Churn</div>
      <div style="font-size:0.84rem; line-height:1.8; color:var(--muted); margin-bottom:16px">
        You can't stop someone from moving home. But you can <strong style="color:var(--text)">learn from them</strong> and <strong style="color:var(--text)">stay in their world</strong>.
      </div>
      <div style="display:flex; flex-direction:column; gap:8px; font-size:0.82rem;">
        <div style="background:rgba(59,130,246,.1); padding:12px 14px; border-radius:10px; border-left:3px solid var(--natural)">
          <div style="font-weight:700; margin-bottom:4px; color:var(--natural)">Exit surveys</div>
          <div style="color:var(--muted)">Even "natural" leavers may have had hidden frustrations. Ask them ‚Äî you'll often discover fixable issues.</div>
        </div>
        <div style="background:rgba(59,130,246,.1); padding:12px 14px; border-radius:10px; border-left:3px solid var(--natural)">
          <div style="font-weight:700; margin-bottom:4px; color:var(--natural)">Re-engagement campaigns</div>
          <div style="color:var(--muted)">People who moved to local cover may return to expat cover later. Keep them warm.</div>
        </div>
        <div style="background:rgba(59,130,246,.1); padding:12px 14px; border-radius:10px; border-left:3px solid var(--natural)">
          <div style="font-weight:700; margin-bottom:4px; color:var(--natural)">Short-term product</div>
          <div style="color:var(--muted)">707 had a "less than 12 months" need. A dedicated short-term product could turn these into converted customers.</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PANEL 4 ‚Äî SERVICE PROBLEMS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="panel" id="panel-service">

  <div class="alert orange">
    <div class="alert-icon">üîß</div>
    <div>
      <div class="alert-title">Service Problems: 1,106 customers who left because of YOU ‚Äî and could have stayed</div>
      <div class="alert-body">Price, coverage gaps, claims handling, customer service quality. These customers didn't have a life change ‚Äî they had a bad experience. Every single one of these could have been prevented.</div>
    </div>
  </div>

  <div class="kpi-row">
    <div class="kpi" style="--accent-color:var(--service)">
      <div class="kpi-label">Controllable Total</div>
      <div class="kpi-value">1,106</div>
      <div class="kpi-sub">9.4% of all cancellations</div>
    </div>
    <div class="kpi" style="--accent-color:#fb923c">
      <div class="kpi-label">Too Expensive</div>
      <div class="kpi-value">458</div>
      <div class="kpi-sub">paid $5,970 avg ‚Äî above average</div>
    </div>
    <div class="kpi" style="--accent-color:#fdba74">
      <div class="kpi-label">Claims Issues</div>
      <div class="kpi-value">147</div>
      <div class="kpi-sub">core product failure</div>
    </div>
    <div class="kpi" style="--accent-color:#fed7aa">
      <div class="kpi-label">Coverage Gaps</div>
      <div class="kpi-value">236</div>
      <div class="kpi-sub">area + benefit limits combined</div>
    </div>
  </div>

  <div class="grid-2">
    <div class="card">
      <div class="card-title"><span>‚â°</span> Service Issues Breakdown</div>
      <div class="hbar">
        <div>
          <div class="hbar-item"><div class="hbar-label">Too expensive</div><div class="hbar-count">458</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:100%;background:var(--service)"><span>41%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Area of coverage not suitable</div><div class="hbar-count">173</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:38%;background:#fb923c"><span>16%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Claims issues</div><div class="hbar-count">147</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:32%;background:#fb923c"><span>13%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Service ‚Äì Payment issues</div><div class="hbar-count">142</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:31%;background:#fdba74"><span>13%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Customer Service issues</div><div class="hbar-count">123</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:27%;background:#fdba74"><span>11%</span></div></div>
        </div>
        <div>
          <div class="hbar-item"><div class="hbar-label">Benefit limit amounts not suitable</div><div class="hbar-count">63</div></div>
          <div class="hbar-track" style="margin-top:4px"><div class="hbar-fill" style="width:14%;background:#fed7aa; min-width:36px"><span>6%</span></div></div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="card-title"><span>‚ú¶</span> Price Deep Dive</div>
      <div style="font-size:0.84rem; color:var(--muted); margin-bottom:16px; line-height:1.7">
        "Too expensive" customers actually <strong style="color:var(--text)">paid more than average</strong> ‚Äî they weren't leaving because they were poor fits. They were leaving because they didn't feel the <strong style="color:var(--text)">value matched the price</strong>.
      </div>

      <div style="display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-bottom:20px">
        <div style="background:rgba(249,115,22,.12); border-radius:12px; padding:14px; text-align:center;">
          <div style="font-size:0.7rem; color:var(--muted); text-transform:uppercase; margin-bottom:4px">Avg price ‚Äî "Too Expensive"</div>
          <div style="font-size:1.7rem; font-weight:700; color:var(--service)">$5,970</div>
        </div>
        <div style="background:rgba(249,115,22,.06); border-radius:12px; padding:14px; text-align:center;">
          <div style="font-size:0.7rem; color:var(--muted); text-transform:uppercase; margin-bottom:4px">Avg price ‚Äî All cancellations</div>
          <div style="font-size:1.7rem; font-weight:700; color:var(--muted)">$5,174</div>
        </div>
      </div>

      <div style="font-size:0.8rem; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:1px; margin-bottom:10px">Actions</div>
      <div style="display:flex; flex-direction:column; gap:7px; font-size:0.82rem;">
        <div style="display:flex; gap:8px; align-items:center; background:var(--surface2); padding:10px 12px; border-radius:10px;">
          <span style="color:var(--service)">‚Üí</span>
          <span>Introduce mid-tier plan option for price-sensitive customers</span>
        </div>
        <div style="display:flex; gap:8px; align-items:center; background:var(--surface2); padding:10px 12px; border-radius:10px;">
          <span style="color:var(--service)">‚Üí</span>
          <span>Audit claims process ‚Äî 147 left due to claims friction</span>
        </div>
        <div style="display:flex; gap:8px; align-items:center; background:var(--surface2); padding:10px 12px; border-radius:10px;">
          <span style="color:var(--service)">‚Üí</span>
          <span>Review product coverage in top markets (US, Canada, France)</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     PANEL 5 ‚Äî TIME IS CRITICAL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="panel" id="panel-time">

  <div class="alert purple">
    <div class="alert-icon">‚è±</div>
    <div>
      <div class="alert-title">Time is Critical: 97% cancel within the first year ‚Äî avg just 5.9 months</div>
      <div class="alert-body">The majority of your churn happens fast. Customers who survive past 12 months tend to stay. This means the first 6 months are your biggest opportunity ‚Äî and biggest risk.</div>
    </div>
  </div>

  <div class="kpi-row">
    <div class="kpi" style="--accent-color:#10b981">
      <div class="kpi-label">Avg Duration</div>
      <div class="kpi-value">5.9 mo</div>
      <div class="kpi-sub">before cancellation</div>
    </div>
    <div class="kpi" style="--accent-color:#34d399">
      <div class="kpi-label">Cancel in Year 1</div>
      <div class="kpi-value">97%</div>
      <div class="kpi-sub">the first year is everything</div>
    </div>
    <div class="kpi" style="--accent-color:#6ee7b7">
      <div class="kpi-label">Peak Cancel Month</div>
      <div class="kpi-value">Month 1</div>
      <div class="kpi-sub">1,027 cancellations</div>
    </div>
    <div class="kpi" style="--accent-color:#a7f3d0">
      <div class="kpi-label">Month 12 Spike</div>
      <div class="kpi-value">1,298</div>
      <div class="kpi-sub">renewal/anniversary effect</div>
    </div>
  </div>

  <div class="grid-2">
    <div class="card" style="grid-column:1/-1">
      <div class="card-title"><span>~</span> Cancellations by Month After Policy Start</div>
      <div class="hist-wrap" id="hist-chart"></div>
      <div class="annotation">
        Months 1, 3, and 12 show the highest spikes ‚Äî focus retention at these exact moments
      </div>
    </div>
  </div>

  <div class="grid-2">
    <div class="card">
      <div class="card-title"><span>‚óë</span> Top 10 Locations by Cancellations</div>
      <div class="hbar" id="location-bars"></div>
    </div>

    <div class="card">
      <div class="card-title"><span>‚ñ¶</span> Cancellations by Age Group</div>
      <div id="age-chart" style="display:flex; flex-direction:column; gap:12px;"></div>
      <div style="margin-top:16px; padding:14px; background:rgba(167,139,250,.08); border-radius:12px; border-left:3px solid var(--accent); font-size:0.82rem; color:var(--muted);">
        <strong style="color:var(--accent)">Key finding:</strong> 30‚Äì39 year olds are the biggest group (27%) and 60+ are second (23%). These two age groups alone represent 50% of all cancellations.
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê JAVASCRIPT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script>
  const DATA = {
    total: 11811,
    categories: [
      { name: "Natural Churn",  n: 6892, pct: 58.4, color: "#3b82f6" },
      { name: "Payment Issues", n: 2434, pct: 20.6, color: "#e53e3e" },
      { name: "Other",          n: 1379, pct: 11.7, color: "#94a3b8" },
      { name: "Service Issues", n: 1106, pct:  9.4, color: "#f97316" },
    ],
    top10: [
      { reason: "Moving back to country of residence", count: 3021, category: "Natural Churn (Life Changes)" },
      { reason: "Moving on to a Local Cover",           count: 1723, category: "Natural Churn (Life Changes)" },
      { reason: "Subsequent premium not received",      count: 1663, category: "Payment/Collection Issues" },
      { reason: "Moving onto Employer scheme",          count: 1199, category: "Natural Churn (Life Changes)" },
      { reason: "Less than 12 months - short term",     count:  707, category: "Natural Churn (Life Changes)" },
      { reason: "Customer unreachable after 7 days",    count:  696, category: "Payment/Collection Issues" },
      { reason: "Too expensive",                        count:  458, category: "Controllable (Service/Product)" },
      { reason: "Visa cancelled by employer",           count:  242, category: "Natural Churn (Life Changes)" },
      { reason: "Area of coverage not suitable",        count:  173, category: "Controllable (Service/Product)" },
      { reason: "Policy No Longer Compliant",           count:  171, category: "Other" },
    ],
    durData: [168,1027,965,1017,740,675,668,542,479,522,406,427,1298],
    locations: [
      { location:"United States",count:1838 },
      { location:"Canada",count:805 },
      { location:"France",count:735 },
      { location:"Italy",count:668 },
      { location:"Spain",count:578 },
      { location:"Germany",count:433 },
      { location:"Portugal",count:334 },
      { location:"Sweden",count:321 },
      { location:"Mexico",count:315 },
      { location:"Thailand",count:313 },
    ],
    payInterval: { Monthly: 8950, Annually: 2109, Quarterly: 752 },
    ageGroups: { "Under 30":2143, "30-39":3231, "40-49":1936, "50-59":1775, "60+":2707 }
  };

  const CAT_COLOR = {
    "Natural Churn (Life Changes)":      "#3b82f6",
    "Payment/Collection Issues":         "#e53e3e",
    "Controllable (Service/Product)":    "#f97316",
    "Other":                             "#94a3b8"
  };

  /* ‚îÄ‚îÄ Donut ‚îÄ‚îÄ */
  function buildDonut() {
    const svg = document.getElementById('donut-svg');
    const cx = 90, cy = 90, r = 70, stroke = 26;
    const circ = 2 * Math.PI * r;
    let offset = 0;
    DATA.categories.forEach(d => {
      const arc = (d.n / DATA.total) * circ;
      const circle = document.createElementNS("http://www.w3.org/2000/svg","circle");
      circle.setAttribute("cx", cx); circle.setAttribute("cy", cy);
      circle.setAttribute("r", r);
      circle.setAttribute("fill","none");
      circle.setAttribute("stroke", d.color);
      circle.setAttribute("stroke-width", stroke);
      circle.setAttribute("stroke-dasharray", `${arc} ${circ - arc}`);
      circle.setAttribute("stroke-dashoffset", -offset);
      circle.style.transition = "stroke-dashoffset 0.5s";
      svg.appendChild(circle);
      offset += arc;
    });

    const legend = document.getElementById('donut-legend');
    DATA.categories.forEach(d => {
      const item = document.createElement('div');
      item.className = 'legend-item';
      item.innerHTML = `
        <div class="legend-dot" style="background:${d.color}"></div>
        <div class="legend-label">${d.name}</div>
        <div class="legend-bar-wrap"><div class="legend-bar" style="background:${d.color};width:${d.pct}%"></div></div>
        <div class="legend-pct" style="color:${d.color}">${d.pct}%</div>
      `;
      legend.appendChild(item);
    });
  }

  /* ‚îÄ‚îÄ Top 10 bars ‚îÄ‚îÄ */
  function buildTop10() {
    const container = document.getElementById('top10-bars');
    const maxVal = DATA.top10[0].count;
    DATA.top10.forEach(d => {
      const pct = (d.count / maxVal * 100).toFixed(1);
      const color = CAT_COLOR[d.category] || "#94a3b8";
      const label = d.reason.length > 38 ? d.reason.slice(0,36)+'‚Ä¶' : d.reason;
      const row = document.createElement('div');
      row.innerHTML = `
        <div class="hbar-item">
          <div class="hbar-label" title="${d.reason}">${label}</div>
          <div class="hbar-count">${d.count.toLocaleString()}</div>
        </div>
        <div class="hbar-track" style="margin-top:4px">
          <div class="hbar-fill" style="width:${pct}%;background:${color}">
            <span>${(d.count/DATA.total*100).toFixed(1)}%</span>
          </div>
        </div>
      `;
      row.style.marginBottom = '6px';
      container.appendChild(row);
    });
  }

  /* ‚îÄ‚îÄ Payment interval ‚îÄ‚îÄ */
  function buildPayInterval() {
    const container = document.getElementById('pay-interval-list');
    const total = Object.values(DATA.payInterval).reduce((a,b)=>a+b,0);
    const entries = Object.entries(DATA.payInterval).sort((a,b)=>b[1]-a[1]);
    const colors = ['#e53e3e','#f87171','#fca5a5'];
    entries.forEach(([name, val], i) => {
      const pct = (val/total*100).toFixed(1);
      const item = document.createElement('div');
      item.className = 'prog-item';
      item.innerHTML = `
        <div class="prog-header">
          <span>${name}</span>
          <span style="font-weight:700;color:${colors[i]}">${val.toLocaleString()} (${pct}%)</span>
        </div>
        <div class="prog-track">
          <div class="prog-fill" style="width:${pct}%;background:${colors[i]}"></div>
        </div>
      `;
      container.appendChild(item);
    });
  }

  /* ‚îÄ‚îÄ Histogram ‚îÄ‚îÄ */
  function buildHistogram() {
    const container = document.getElementById('hist-chart');
    const maxVal = Math.max(...DATA.durData);
    const maxH = 130; // px

    DATA.durData.forEach((count, i) => {
      const heightPx = Math.round((count / maxVal) * maxH);
      const isMonth12 = i === 12;
      const isEarly = i <= 5;

      let color;
      if (isMonth12) color = '#a78bfa';
      else if (i === 0 || i === 1) color = '#e53e3e';
      else if (isEarly) color = '#f97316';
      else color = '#3b82f6';

      const outer = document.createElement('div');
      outer.className = 'hist-bar-outer';

      const bar = document.createElement('div');
      bar.className = 'hist-bar';
      bar.style.height = '0px';
      bar.style.background = color;
      bar.style.opacity = '0.82';
      bar.title = `Month ${i}: ${count.toLocaleString()} cancellations`;

      const tooltip = document.createElement('div');
      tooltip.className = 'hist-tooltip';
      tooltip.textContent = `Month ${i}: ${count.toLocaleString()}`;
      bar.appendChild(tooltip);

      const label = document.createElement('div');
      label.className = 'x-label';
      label.textContent = i === 0 ? '0' : i % 3 === 0 ? `${i}` : '';

      outer.appendChild(bar);
      outer.appendChild(label);
      container.appendChild(outer);

      // animate after render
      requestAnimationFrame(() => {
        setTimeout(() => { bar.style.height = heightPx + 'px'; }, 80 + i * 30);
      });
    });

    // 12-month line
    // roughly: position of month-12 bar = (12/12) * 100% across
    const line = document.createElement('div');
    line.className = 'hist-line';
    line.style.left = `${(12.5 / 13) * 100}%`;
    line.style.borderColor = '#a78bfa';
    container.appendChild(line);

    const lineLabel = document.createElement('div');
    lineLabel.className = 'hist-line-label';
    lineLabel.style.left = `${(12.5 / 13) * 100 - 2}%`;
    lineLabel.style.background = '#a78bfa22';
    lineLabel.style.color = '#a78bfa';
    lineLabel.style.borderLeft = '2px solid #a78bfa';
    lineLabel.textContent = '12-month mark';
    container.appendChild(lineLabel);
  }

  /* ‚îÄ‚îÄ Locations ‚îÄ‚îÄ */
  function buildLocations() {
    const container = document.getElementById('location-bars');
    const maxVal = DATA.locations[0].count;
    const colors = ['#3b82f6','#60a5fa','#93c5fd','#bfdbfe'];
    DATA.locations.forEach((d, i) => {
      const pct = (d.count / maxVal * 100).toFixed(1);
      const color = colors[Math.min(i, colors.length-1)];
      const row = document.createElement('div');
      row.innerHTML = `
        <div class="hbar-item">
          <div class="hbar-label">${d.location}</div>
          <div class="hbar-count">${d.count.toLocaleString()}</div>
        </div>
        <div class="hbar-track" style="margin-top:4px">
          <div class="hbar-fill" style="width:${pct}%;background:${color}">
            <span>${(d.count/DATA.total*100).toFixed(1)}%</span>
          </div>
        </div>
      `;
      row.style.marginBottom = '6px';
      container.appendChild(row);
    });
  }

  /* ‚îÄ‚îÄ Age Groups ‚îÄ‚îÄ */
  function buildAgeGroups() {
    const container = document.getElementById('age-chart');
    const entries = Object.entries(DATA.ageGroups);
    const totalAge = entries.reduce((s,[,v])=>s+v,0);
    const maxVal = Math.max(...entries.map(([,v])=>v));
    const ageColors = ['#6ee7b7','#34d399','#10b981','#059669','#047857'];
    entries.forEach(([name, val], i) => {
      const pct = (val/totalAge*100).toFixed(1);
      const barPct = (val/maxVal*100).toFixed(1);
      const color = ageColors[i];
      const item = document.createElement('div');
      item.className = 'prog-item';
      item.innerHTML = `
        <div class="prog-header">
          <span style="font-weight:600">${name}</span>
          <span style="font-weight:700;color:${color}">${val.toLocaleString()} <span style="color:var(--muted);font-weight:400">(${pct}%)</span></span>
        </div>
        <div class="prog-track">
          <div class="prog-fill" style="width:${barPct}%;background:${color}"></div>
        </div>
      `;
      container.appendChild(item);
    });
  }

  /* ‚îÄ‚îÄ Tab switching ‚îÄ‚îÄ */
  function switchTab(id) {
    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById('panel-' + id).classList.add('active');
    document.getElementById('tab-' + id).classList.add('active');
  }

  // Init
  buildDonut();
  buildTop10();
  buildPayInterval();
  buildHistogram();
  buildLocations();
  buildAgeGroups();
</script>
</body>
</html>
